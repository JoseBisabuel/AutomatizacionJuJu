Feature: Comunicados

  Background:
    Given Sitio AZDigital
    Then Cargar la informacion del DOM Comunicados.json
    And lleneme el campo Usuario con el texto meyer.ayala
    And lleneme el campo Contrasena con el texto o<tf@LqI4!~h
    And Hacer Click en El elemento Ingresar

    ##--Creacion de Usuario--##
  @CreaColeccion
  Scenario: Creacion Coleccion Comunicados salida
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento GestionContenido
    And Hacer Click en El elemento Estructura
    And Cambiar de Frame: FrameEstructura
    And Sikuli element click EstAutomatizacion
    And Cambiar al Frame principal
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento EstUsuarios
    And Hacer Click en El elemento ColUsuarios
    And lleneme el campo Crear con el texto ComunicadoSA
    And Texto de Seleccion Colección Selector SelectTipo
    And Hacer Click en El elemento BotonCrear
    And espereme 2 segundos

  @CreacionBDETresPuntos
  Scenario: Creacion BDE BDEComSA
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento GestionContenido
    And Hacer Click en El elemento Estructura
    And Cambiar de Frame: FrameEstructura
    And Sikuli element click EstAutomatizacion
    And Cambiar al Frame principal
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento EstUsuarios
    And Hacer Click en El elemento ColUsuarios
    And espereme 2 segundos
    And Sikuli element click ColComunicadoSA
    And lleneme el campo Crear con el texto BDEComSA
    And Texto de Seleccion Bandeja de Entrada Selector SelectTipo
    And Hacer Click en El elemento BotonCrear
    And espereme 2 segundos
    #And lleneme el campo Crear con el texto BDE_ComunicadoSARec
    #And Texto de Seleccion Bandeja de Entrada Selector SelectTipo
    #And Hacer Click en El elemento BotonCrear
    #And espereme 2 segundos

  @CreacionUsuarioTresPuntos
  Scenario: Creacion Usuarios ComunicadosSA
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento AdminUsuarios
    And Hacer Click en El elemento OpcUsuarios
    And Hacer Click en El elemento CrearUsuarios
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And lleneme el campo UsUser con el texto comunicadossa
    And lleneme el campo UsPass con el texto 1Q2w3e4r5t*
    And Texto de Seleccion Administrador AZ Digital Selector Ustipo
    And lleneme el campo UsNombre con el texto Usuario
    And lleneme el campo UsApellido con el texto Comunicados Salida
    And Selecion Index 3 Selector UsTid
    And lleneme el campo UsIdentificacion con el texto 858585
    And lleneme el campo UsBDE con el texto BDEComSA
    And espereme 5 segundos
    And Hacer Click en El elemento UsBotonBuscarBDE
      #And Selecion Index 1 Selector UsBDE
    And Hacer Click en El elemento RegistroUsuario
    And lleneme el campo UsEmail con el texto pruebasqa311@yopmail.com
    And Opcion del select Crear, Aprobar y Radicar Comunicados y el select UsTipoRadComunicados
    And Hacer Click en El elemento UsBotonAgregar
    And espereme 2 segundos

  @ParametrizacionCargos
  Scenario: Cargo Usuario comunicadossa
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento AdminUsuarios
    And Hacer Click en El elemento CargosUsuarios
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento BotonAgregarCargo
    And Selecion Index 1 Selector CampoDependencia
    And Selecion Index 1 Selector CampoCargo
    And Texto de Seleccion Usuario Comunicados Salida Selector CampoUsuario
    And Hacer Click en El elemento BotonCargosUsuario

  @ParametrizacionTiposRadicados
  Scenario: Tipos Radicados - Coleccion - Interno - ComunicadosSA
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento RetencionDocumental
    And Hacer Click en El elemento TiposDocumColeccion
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento BotonAgregarDColeccion
    And Selecion Index 1 Selector TdTablaRetencion
    And Selecion Index 1 Selector TdTipoRadicado
    And Texto de Seleccion Comunicado Interno:002:Comunicado Interno:.docx Selector TdTipodocumental
    And Texto de Seleccion ComunicadoSA Selector TdColeccion
    And Selecion Index 1 Selector TdSDocumental
    And Hacer Click en El elemento TDAgregarTDocumental

  @ParametrizacionTiposRadicadosSal0
  Scenario: Tipos Radicados - Coleccion - Salida - ComunciadosSA
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento RetencionDocumental
    And Hacer Click en El elemento TiposDocumColeccion
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento BotonAgregarDColeccion
    And Selecion Index 1 Selector TdTablaRetencion
    And Selecion Index 2 Selector TdTipoRadicado
    And Texto de Seleccion Acta:001:Acta:.docx Selector TdTipodocumental
    And Texto de Seleccion ComunicadoSA Selector TdColeccion
    And Selecion Index 1 Selector TdSDocumental
    And Hacer Click en El elemento TDAgregarTDocumental

  @AsociarColeccionesTresPuntos
  Scenario: Asociar Colecciones ComunicadosSA
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento AdminUsuarios
    And Hacer Click en El elemento AsociarColecciones
    And espereme 2 segundos
    And Texto de Seleccion Administrador AZDigital Selector UsuarioOrigen
    And Texto de Seleccion Usuario Comunicados Salida Selector UsuarioDestino
    And Hacer Click en El elemento EjecutarAsociar
    And se accept la alerta
    ##--Creacion de Usuario--##

    ##--Comunicados Guardados--##
  @CrearDirectorioComunicados
  Scenario: Crear directorio - Comunicado guardado
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento GestionContenido
    And Hacer Click en El elemento Estructura
    And Cambiar de Frame: FrameEstructura
    And Sikuli element click EstAutomatizacion
    And Cambiar al Frame principal
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento EstUsuarios
    And Hacer Click en El elemento ColUsuarios
    And espereme 2 segundos
    And Sikuli element click ColComunicadoSA
    #And Sikuli element click BDE_ComnSal
    And Hacer Click en El elemento BDE_ComnSal
    And espereme 2 segundos
    And lleneme el campo Crear con el texto ComunicadosGuardados
    And Texto de Seleccion Carpeta Privada Selector SelectTipo
    And Hacer Click en El elemento BotonCrear

  @CrearComunicado1
  Scenario Outline: Crear directorio - Comunicado guardado
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento GestionContenido
    And Hacer Click en El elemento Estructura
    And Cambiar de Frame: FrameEstructura
    And Sikuli element click EstAutomatizacion
    And Cambiar al Frame principal
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento EstUsuarios
    And Hacer Click en El elemento ColUsuarios
    And espereme 5 segundos
    And Sikuli element click ColComunicadoSA
    And Hacer Click en El elemento BDE_ComnSal
    And Sikuli element click ComunicadosGuardados
    And lleneme el campo Crear con el texto <Campo1>
    And Texto de Seleccion Documento Radicado Selector SelectTipo
    And Texto de Seleccion Acta Selector TDocumental2
    And Hacer Click en El elemento BotonCrear
    And Hacer Click en El elemento Agregar_ListaPersonas
        #--Validación ventana Personas--#
    And ir a <Campo2> ventana
    And Cambiar de Frame: BuscarUsuariosPersonas
    And lleneme el campo PersNombre con el texto Automatizacion Persona Cero Uno
    And Adjunto una Captura de pantalla al informe AgrPersguaradado
    And Hacer Click en El elemento BotonAgregarPersona
    And espereme 2 segundos
    And Cambiar al Frame principal
    And Cambiar de Frame: AgregarUsuariosPersonas
    And Adjunto una Captura de pantalla al informe AgrPers02
    And Hacer Click en El elemento AsociarPersona
    And espereme 3 segundos
        #--Validación ventana Personas--#
    And ir a <Campo3> ventana
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Selecion Index 1 Selector CTramite
    And Selecion Index 1 Selector CSubtramite
    And Selecion Index 1 Selector Courier
    And Selecion Index 2 Selector ModalidaEnvio
    And lleneme el campo Peso con el texto 123
    And lleneme el campo Costo con el texto 50000
    And Texto de Seleccion 1 a 1 Selector CModoSalida
    And lleneme el campo CIdReferencia con el texto Auto01
    And lleneme el campo CNo.Folios con el texto 1
    And lleneme el campo CNo.DocAnexos con el texto 1
    And lleneme el campo CAsunto con el texto Opción Guardar - Opción Guardar - Opción Guardar - Opción Guardar - Opción Guardar -
    And Hacer Click en El elemento BGuardar
    Examples:
      | Campo1 | Campo2 | Campo3 |
      | Guardado01 | PersonaGuardado1 | Principalguardado01 |
      | Guardado02 | PersonaGuardado2 | Principalguardado02 |
      | Guardado03 | PersonaGuardado3 | Principalguardado03 |

  @CrearComunicado2
  Scenario: Crear directorio - Comunicado guardado
    And Hacer Click en El elemento Menu
    And Cambiar de Frame: Opciones
    And Hacer Click en El elemento GestionContenido
    And Hacer Click en El elemento Estructura
    And Cambiar de Frame: FrameEstructura
    And Sikuli element click EstAutomatizacion
    And Cambiar al Frame principal
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Hacer Click en El elemento EstUsuarios
    And Hacer Click en El elemento ColUsuarios
    And espereme 5 segundos
    And Sikuli element click ColComunicadoSA
    And Hacer Click en El elemento BDE_ComnSal
    And Sikuli element click ComunicadosGuardados
    And lleneme el campo Crear con el texto Guardado04
    And Texto de Seleccion Documento Radicado Selector SelectTipo
    And Texto de Seleccion Acta Selector TDocumental2
    And Hacer Click en El elemento BotonCrear
    And Hacer Click en El elemento Agregar_ListaPersonas
        #--Validación ventana Personas--#
    And ir a PersonaGuardado4 ventana
    And Cambiar de Frame: BuscarUsuariosPersonas
    And lleneme el campo PersNombre con el texto Automatizacion Persona Cero Uno
    And Adjunto una Captura de pantalla al informe AgrPersguaradado
    And Hacer Click en El elemento BotonAgregarPersona
    And espereme 2 segundos
    And Cambiar al Frame principal
    And Cambiar de Frame: AgregarUsuariosPersonas
    And Adjunto una Captura de pantalla al informe AgrPers02
    And Hacer Click en El elemento AsociarPersona
    And espereme 3 segundos
        #--Validación ventana Personas--#
    And ir a Principalguardado04 ventana
    And Cambiar al Frame principal
    And Cambiar de Frame: Contenido
    And Selecion Index 1 Selector CTramite
    And Selecion Index 1 Selector CSubtramite
    And Selecion Index 1 Selector Courier
    And Selecion Index 2 Selector ModalidaEnvio
    And lleneme el campo Peso con el texto 123
    And lleneme el campo Costo con el texto 50000
    And Texto de Seleccion 1 a 1 Selector CModoSalida
    And lleneme el campo CIdReferencia con el texto Auto01
    And lleneme el campo CNo.Folios con el texto 1
    And lleneme el campo CNo.DocAnexos con el texto 1
    And lleneme el campo CAsunto con el texto Opción Guardar - Opción Guardar - Opción Guardar - Opción Guardar - Opción Guardar -
    And Hacer Click en El elemento BGuardar
    ##--Comunicados Gusrdados--##