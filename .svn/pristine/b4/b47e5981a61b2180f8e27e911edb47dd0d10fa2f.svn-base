  Feature: MasInformacionBDE

    Background:
      Given Sitio AZDigital
      Then Cargar la informacion del DOM MasInformacion.json
      And lleneme el campo Usuario con el texto UserAutomatizacion
      And lleneme el campo Clave con el texto Automatizacion1*
      And Hacer Click en El elemento Ingreso
      And Hacer Click en El elemento BDE
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And Hacer Click en El elemento Atras

    @CrearCarpetaMover
    Scenario: Crear Carpeta Mover
      And Hacer Click en El elemento BDE_Traslado
      And lleneme el campo Crear con el texto MoverAuto
      And Selecion Index 0 Selector Nombre
      And Hacer Click en El elemento BtnCrear
      And espereme 2 segundos

    @CrearBDE
    Scenario Outline: Crear BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And lleneme el campo Crear con el texto <NombreBDE>
      And espereme 2 segundos
      And Selecion Index 0 Selector Nombre
      And Hacer Click en El elemento BtnCrear
      Examples:
        | NombreBDE |
        | BDE      |
        | BDE1     |
        | BDE2     |
        | BDE3     |
        | BDE4     |

    @PestañaGeneralSeleccioneUnaAccionPublicarBDE
    Scenario: Publicar Coleccion
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento ListaPublicar
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Desplazo el elemento PubliColeccion
      And espereme 2 segundos
      And Hacer Click en El elemento PubliColeccion
      And espereme 3 segundos
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And lleneme el campo ObservacionPubli con el texto Sin observaciones
      And lleneme el campo FechaPubli con el texto 2023-12-30
      And Hacer Click en El elemento BtnPubliCarpeta

    @PestañaGeneralSeleccioneUnaAccionMoverBDE
    Scenario: Mover BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And Hacer Click en El elemento ListaMover
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Mover
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
    #No se puede mover a Bandejas de entradas
      And lleneme el campo NuevaLocalizacionColeccion con el texto MoverAuto
      And Hacer Click en El elemento Buscar
      And Hacer Click en El elemento SelecBDEColeccion
      And Hacer Click en El elemento BtnMover
      And espereme 3 segundos
      And Hacer Click en El elemento Atras
      And Hacer Click en El elemento BDE_Traslado
      And Hacer Click en El elemento MoverAuto
      And espereme 2 segundos

    @PestañaGeneralSeleccioneUnaAccionBorrarBDE
    Scenario: Borrar BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And Hacer Click en El elemento ListaBorrar
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Borrar
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento BtnBorrar
      And espereme 2 segundos

    @PestañaGeneralMasInformacionTrasladarBDE
    Scenario: Trasladar BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And Hacer Click en El elemento ListaTrasladar
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And Desplazo el elemento Trasladar
      And espereme 2 segundos
      And Hacer Click en El elemento Trasladar
      And espereme 2 segundos
      And Adjunto una Captura de pantalla al informe Trasladar

    @BorraryCrear
    Scenario: Borrar y Crear1
      And espereme 10 segundos
      And Hacer Click en El elemento ColecAutomatizacion
      And Marco la casilla de verificación que tiene SelectDepurar
      And Hacer Click en El elemento Lista
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Borrardepurar
      And Hacer Click en El elemento Actualizar
      And lleneme el campo Crear con el texto ColeccionMetadata
      And espereme 2 segundos
      And Selecion Index 0 Selector Nombre
      And Hacer Click en El elemento BtnCrear

    @PestañaGeneral-MasInfo-Compartir-BDE
    Scenario: Compartir BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento ListaComp
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Compartir
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And lleneme el campo ObservacionCompartir con el texto Sin comentarios
      And lleneme el campo SelecEmail con el texto NotificacionesAuto@yopmail.com
      And lleneme el campo Fecha con el texto 2023-12-30
      And Hacer Click en El elemento BtnCompartir
    #And tomar Captura de pantalla: Compartir
      And ir a la pestaña https://www.google.com
      And Ir a yopmail
      And lleneme el campo CorreoYop con el texto notificacionesauto
      And Hacer Click en El elemento AbrirCorreo
      And Cambiar de Frame: Frameyop
      And espereme 3 segundos
      And Hacer Click en El elemento AbrirCarpetaComp
      And espereme 5 segundos
      And Adjunto una Captura de pantalla al informe CorreoTraslado

    @PestañaCompartido
    Scenario: Pestaña Compartido
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 3 segundos
      And Hacer Click en El elemento Compartido
      And Adjunto una Captura de pantalla al informe Compartido

    @Calcular-Tamaño/Abrir-Coleccion
    Scenario: Calcular Tamaño y Abrir Coleccion
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento ColecCalcular
      And Subir Archivos PDF SubirArchivos
      And espereme 15 segundos
      And Hacer Click en El elemento Atras
      And Hacer Click en El elemento MasInfoColeccion
      And espereme 3 segundos
      And Hacer Click en El elemento CalcularTamaño
      And espereme 2 segundos
      And Hacer Click en El elemento Aceptar
      And espereme 2 segundos
      And Adjunto una Captura de pantalla al informe Tamaño
      And Hacer Click en El elemento AbrirCarpeta
      And Adjunto una Captura de pantalla al informe Abrir

    @MetadataColeccion
    Scenario: Metadata Coleccion
      And espereme 3 segundos
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 5 segundos
      And Hacer Click en El elemento Metadata
      And espereme 2 segundos
      And Texto de Seleccion SAS: Facturas Selector CategoriaMetaColeccion
      And espereme 2 segundos
      And Hacer Click en El elemento CerrarCuadro
      And lleneme el campo DescripcionMetaCarpeta con el texto Sin descripción
      And lleneme el campo PalabraClaveCarpeta con el texto Prueba
      And lleneme el campo ObservacionesMetaCarpeta con el texto Sin observaciones
      And Hacer Click en El elemento ActualizarMeta
      And Adjunto una Captura de pantalla al informe Metadata5

    @DatosAsociadosBDE
    Scenario: Datos Asociados BDE
      And espereme 3 segundos
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 5 segundos
      And Hacer Click en El elemento Metadata
      And espereme 2 segundos
      And Hacer Click en El elemento DatosAsociadosCarpeta
      And espereme 2 segundos
      And lleneme el campo NumeroFactura con el texto Automatizacion600
      And lleneme el campo NombreEmpresa con el texto Analitica
      And lleneme el campo ValorFactura con el texto 9999
      And Hacer Click en El elemento BtnAsociarDatos
    #And Adjunto una Captura de pantalla al informe DatosAsociados
      And Marco la casilla de verificación que tiene SelectDatos
      And Hacer Click en El elemento VerLibro
      And espereme 2 segundos
      And Adjunto una Captura de pantalla al informe Verlibro
      And espereme 3 segundos

    @BitacoraDeAccionesBDE
    Scenario: Bitacora de Acciones BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento BitacoraCarpeta
      And Hacer Click en El elemento Filtrar
      And Selecion Index 1 Selector FiltroUsuario
      And espereme 2 segundos
      And Hacer Click en El elemento BtnFiltroBitacora
      And Hacer Click en El elemento BtnVerTodo
      And Adjunto una Captura de pantalla al informe Bitacora6

    @BorraryCrear
    Scenario: Borrar y Crear
      And Hacer Click en El elemento ColecAutomatizacion
      And Marco la casilla de verificación que tiene SelectDepurar
      And Hacer Click en El elemento Lista
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Borrardepurar
      And Hacer Click en El elemento Actualizar
      And lleneme el campo Crear con el texto BDEMetadata
      And espereme 2 segundos
      And Selecion Index 0 Selector Nombre
      And Hacer Click en El elemento BtnCrear

    @MetadataBDEIndexar
    Scenario: Metadata BDE Indexar
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento ColeccionIndexar
      And Subir Archivos PDF SubirArchivos
      And espereme 5 segundos
      And Hacer Click en El elemento Atras
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 5 segundos
      And Hacer Click en El elemento Metadata
      And espereme 2 segundos
      And Hacer Click en El elemento IndexarColeccion
      And Cambiar de Frame: Categoria
      And Texto de Seleccion SAS Selector ModuloIndexcarpeta
      And espereme 3 segundos
      And Selecion Index 1 Selector IndiceColeccion
      And espereme 3 segundos
      And Selecion Index 0 Selector SubIndiceColeccion
      And espereme 2 segundos
      And Cambiar al Frame principal
      And Cambiar de Frame: Indice
      And espereme 2 segundos
      And lleneme el campo NumeroFactura con el texto 1020
      And lleneme el campo NombreEmpresa con el texto automatizacion
      And lleneme el campo ValorFactura con el texto 12000
      And Hacer Click en El elemento AgregarIndex
      And Cambiar al Frame principal
      And espereme 2 segundos
      And Cambiar de Frame: Categoria
      And espereme 2 segundos
      And Hacer Click en El elemento VolverIndex
      And espereme 2 segundos
      And Adjunto una Captura de pantalla al informe Indexar2

    @MetadataBorrarIndicesBDE
    Scenario: Metadata Borrar Indices BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And espereme 5 segundos
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Metadata
      And espereme 2 segundos
      And Texto de Seleccion SAS: Facturas Selector CategoriaMetaColeccion
      And espereme 2 segundos
      And Hacer Click en El elemento CerrarCuadro
      And espereme 2 segundos
      And Hacer Click en El elemento BorrarIndice
      And espereme 2 segundos
      And Adjunto una Captura de pantalla al informe VisualizarIndice
      And Marco la casilla de verificación que tiene SelecBorrarIndice
      And Hacer Click en El elemento Lista
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Borrarindice
      And Hacer Click en El elemento Actualizar
      And espereme 3 segundos
      And Adjunto una Captura de pantalla al informe BorrarIndice

    @MetadataExportarBDE
    Scenario Outline: Metadata Exportar BDE
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Metadata
      And espereme 2 segundos
      And Hacer Click en El elemento ExportarCarpeta
      And Hacer Click en El elemento BtnExportarCarpeta
      And Marco la casilla de verificación que tiene ExportarArchivos
      And Selecion Index 1 Selector Modalidades
      And Marco la casilla de verificación que tiene ExportarMetadata
      And Marco la casilla de verificación que tiene MetadataGeneral
      And Marco la casilla de verificación que tiene MetadataIndices
      And Opcion del select <campo1> y el select Formato
      And espereme 2 segundos
      And Hacer Click en El elemento AceptarExportar
      And espereme 2 segundos
      Examples:
        | campo1 |
        | TAB    |
        | CSV    |
        | Pipe   |
        | XML    |

    @LocalizacionPrestamos
    Scenario: Localizacion Prestamos
      And Hacer Click en El elemento ColecAutomatizacion
      And Hacer Click en El elemento MasInfoColeccion
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And Hacer Click en El elemento LocalizacionCarpeta
      And espereme 2 segundos
      And lleneme el campo MaximoPrestamo con el texto 8
      And Hacer Click en El elemento BtnActualizar
      And Adjunto una Captura de pantalla al informe Prestamo

    @Borrar
    Scenario: Borrar
      And Hacer Click en El elemento ColecAutomatizacion
      And Marco la casilla de verificación que tiene SelectDepurar
      And Hacer Click en El elemento Lista
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Borrardepurar
      And Hacer Click en El elemento Actualizar
      And Hacer Click en El elemento Atras
      And Hacer Click en El elemento BDE_Traslado
      And Marco la casilla de verificación que tiene SelectDepurar
      And Hacer Click en El elemento Lista
      And Cambiar al Frame principal
      And Cambiar de Frame: Contenido
      And espereme 2 segundos
      And Hacer Click en El elemento Borrardepurar
      And Hacer Click en El elemento Actualizar